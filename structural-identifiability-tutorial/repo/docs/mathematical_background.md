# Mathematical Background: Structural Identifiability

This document provides an extended mathematical reference for the concepts covered in the tutorial notebook. It is intended for readers who want deeper theoretical understanding.

## 1. State Space Representation

We consider systems of the form:

```
dx/dt = f(x(t), u(t), θ)
y(t)  = g(x(t), θ)
x(0)  = x₀(θ)
```

where:
- `x(t) ∈ ℝⁿ` — state vector
- `u(t) ∈ ℝᵐ` — known input
- `θ ∈ Θ ⊆ ℝᵖ` — unknown parameters
- `y(t) ∈ ℝᵍ` — measured output

The functions `f` and `g` are assumed to be **rational** (polynomials or ratios of polynomials) in their arguments.

## 2. Formal Definitions

### Input-Output Equivalence

Two parameter vectors `θ` and `θ̄` are **input-output equivalent** (written `θ ~ θ̄`) if for every admissible input `u(·)`:

```
y(t; θ) = y(t; θ̄)  for all t ≥ 0
```

### Structural Global Identifiability (SGI)

Parameter `θᵢ` is **structurally globally identifiable** if, for generic `θ*`:

```
θ ~ θ*  ⟹  θᵢ = θᵢ*
```

"Generic" means for all `θ*` except possibly a set of Lebesgue measure zero.

### Structural Local Identifiability (SLI)

Parameter `θᵢ` is **structurally locally identifiable** if there exists a neighborhood `N(θ*)` such that:

```
θ ∈ N(θ*) and θ ~ θ*  ⟹  θᵢ = θᵢ*
```

### Structural Nonidentifiability (SNI)

Parameter `θᵢ` is **structurally nonidentifiable** if it is not locally identifiable — meaning a continuous family of parameter values produces identical outputs.

## 3. Methods for Testing Identifiability

### 3.1 Taylor Series Method (Pohjanpalo, 1978)

**Idea:** Expand the output as a Taylor series about t = 0. The Taylor coefficients are functions of parameters. Identifiability reduces to whether these coefficient equations have a unique solution.

**Algorithm:**
1. Compute `y⁽ᵏ⁾(0; θ)` for k = 0, 1, ..., K
2. Set `y⁽ᵏ⁾(0; θ) = y⁽ᵏ⁾(0; θ*)` for all k
3. Solve for `θ` in terms of `θ*`
4. Unique solution → GI; finitely many → LI; infinitely many → NI

**Bound:** K ≤ 2(n + p) - 1 suffices for generic rational systems.

### 3.2 Differential Algebra Method (Ljung and Glad, 1994)

**Idea:** Eliminate state variables algebraically to obtain input-output equations involving only y, ẏ, ÿ, ..., u, u̇, ..., and θ.

**Algorithm:**
1. Form the differential ideal generated by ẋᵢ - fᵢ and yⱼ - gⱼ
2. Compute a characteristic set with elimination ranking
3. Extract input-output equations
4. Extract the coefficient map Φ(θ) = (c₁(θ), ..., cᵣ(θ))
5. Test injectivity of Φ

**Key theorem (Ljung-Glad):** The model is globally identifiable if and only if Φ is injective.

### 3.3 Observability Rank Condition (Hermann and Krener, 1977)

**Idea:** Treat parameters as additional states with zero dynamics. Test observability of the augmented system using Lie derivatives.

**Algorithm:**
1. Form augmented state ξ = (x, θ) with θ̇ = 0
2. Compute Lie derivatives of outputs along the augmented vector field
3. Form the observability matrix O_I from gradients of Lie derivatives
4. If rank(O_I) = n + p, the model is locally identifiable

**Limitation:** Tests only local identifiability. Full rank does not preclude isolated ambiguities at finite distance.

### 3.4 Probabilistic Methods (Hong et al., 2019; Dong et al., 2023)

Modern implementations substitute random numerical values for the generic parameter point, converting symbolic computations to numerical ones. This dramatically accelerates the analysis while maintaining correctness with high probability.

## 4. Identifiable Functions

When individual parameters are nonidentifiable, the **field of identifiable functions** characterizes exactly what information the data can provide.

**Definition:** A function h(θ) is identifiable if θ ~ θ̄ implies h(θ) = h(θ̄).

The function `find_identifiable_functions` in StructuralIdentifiability.jl computes generators of this field automatically.

## 5. Connection to Observability

Structural identifiability of parameters is equivalent to observability of the parameter components in the augmented state space. This connection, due to Hermann and Krener (1977), provides a geometric interpretation: nonidentifiable parameters correspond to directions in parameter space along which the augmented system is unobservable.

## References

- Bellman, R. and Åström, K.J. (1970). Mathematical Biosciences, 7(3-4), 329-339.
- Ljung, L. and Glad, T. (1994). Automatica, 30(2), 265-276.
- Hermann, R. and Krener, A.J. (1977). IEEE Trans. Automatic Control, 22(5), 728-740.
- Pohjanpalo, H. (1978). Mathematical Biosciences, 41(1-2), 21-33.
- Hong, H. et al. (2019). Bioinformatics, 35(16), 2873-2874.
- Dong, R. et al. (2023). SIAM J. Applied Algebra and Geometry, 7(1), 194-235.
